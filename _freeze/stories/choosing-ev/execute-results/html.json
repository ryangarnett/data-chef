{
  "hash": "283e520c856260e2d605c4ddac1bce35",
  "result": {
    "markdown": "---\ntitle: \"Choosing an Electric Vehicle\"\nauthor: \"Ryan Garnett\"\ndate: \"2023-04-14\"\ncategories: [EV, modelling]\n---\n\n\n# Purpose\n\nElectric vehicles (EV) are increasing in popularity, by both the consumer and automakers. There are a significant number of EV available on the market, each having different features and characteristics. With EVs being relatively new to the vehicle market, it can be very difficult to know which EVs to consider as a new vehicle. Within this story we will present a *data driven* approach for making an informed decision when looking for new electric vehicles. A number of EVs will be evaluated based on objective features, omitting things like appearance, style, etc. A custom analytical model will be created to analyze the features and suggest the top electric vehicles.\n\n# Story Setup {.tabset}\n\nIn order to tell a data story there are certain things that are required (i.e. packages, importing data, custom functions, etc.). This section outlines the required pieces to tell our data story.\n\n::: panel-tabset\n## Load Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data access package\nlibrary(readr)\n\n# Data wrangling package\nlibrary(dplyr)\n\n# Data presentation packages\nlibrary(ggplot2)\nlibrary(DT)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n## Import Dataset\n\nData about electric vehicles (manufacture, model, type, price, range, and drive train) were collected during the third week of March 2023, using Nova Scotia Canada as a location for calculating pricing. The type of electric vehicle was broken into two group full electric (EV) and plug-in hybrid electric (PHEV); non plug-in hybrid vehicles were omitted from the data collection.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data collected on electric vehicles\n# Luxury electric vehicles were omitted from data collection\nvehicles <- readr::read_csv(\"https://codeberg.org/data-chef/data-stories/raw/branch/main/data-stories-blogsite/stories/data/ev-vehicles.csv\", col_types = cols())\n```\n:::\n\n\n## Custom ggplot2 Theme\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Custom theme\ndata_chef_theme <- ggplot2::theme(\n  \n    # Text -- title, subtitle, labels, and caption\n    plot.title = ggplot2::element_text(colour = \"#404040\", size = 14, family = \"Roboto\", face = \"bold\"),\n    plot.subtitle = ggplot2::element_text(colour = \"#404040\", size = 12, family = \"Roboto\"),\n    axis.title.x = ggplot2::element_text(colour = \"#404040\", size = 10, family = \"Roboto\"),\n    axis.title.y = ggplot2::element_text(colour = \"#404040\", size = 10, family = \"Roboto\"),\n    legend.title = ggplot2::element_text(colour = \"#404040\", size = 8, family = \"Roboto\"),\n    legend.text = ggplot2::element_text(colour = \"#404040\", size = 8, family = \"Roboto\"),\n    axis.text.x = ggplot2::element_text(colour = \"#404040\", size = 8, family = \"Roboto\"),\n    axis.text.y = ggplot2::element_text(colour = \"#404040\", size = 8, family = \"Roboto\"),\n    plot.caption = ggplot2::element_text(colour = \"#404040\", size = 6, family = \"Roboto\"),\n    \n    # Chart elements -- grids\n    panel.grid.major.x = ggplot2::element_blank(),\n    panel.grid.major.y = ggplot2::element_line(colour = \"#BFBFBF\", linetype = \"dotted\", linewidth = 0.3),\n    panel.grid.minor.x = ggplot2::element_blank(),\n    panel.grid.minor.y = ggplot2::element_blank(),\n    panel.background = element_blank()\n  ) \n```\n:::\n\n:::\n\n<br> <br>\n\n# Data Exploration\n\nAn essential aspect of all data analysis is exploring the data. Through the exploration you become familiar with the elements that are available within the dataset(s), as well as the potential analysis that can be performed with the dataset(s).\n\nThere were **29** vehicles from **13** car manufactures being evaluated.\n\n<br>\n\n::: panel-tabset\n## Tabular View\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-035eee53ba0efe2493d4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-035eee53ba0efe2493d4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\"],[\"BMW\",\"BMW\",\"Chevy\",\"Chevy\",\"Ford\",\"Ford\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Jeep\",\"Jeep\",\"Kia\",\"Kia\",\"Mazda\",\"Mitsubishi\",\"Nissan\",\"Nissan\",\"Subaru\",\"Tesla\",\"Tesla\",\"Tesla\",\"Toyota\",\"Toyota\",\"VW\",\"VW\"],[\"i4 M50\",\"i4 eDrive35\",\"Bold EUV\",\"Bolt EV\",\"Mustang Mach-e California Route 1\",\"Mustang Mach-e Select\",\"Ioniq 5 Preferred\",\"Ioniq 5 Preferred AWD Long Range\",\"Ioniq 5 Preferred Long Range\",\"Kona Preffered\",\"Kona Ultimate\",\"Santa Fe Luxury Plug-in Hybrid AWD\",\"Tuscon Luxury Plug-in Hybrid AWD\",\"4-Door Willys\",\"Grand Cherokee 4XE\",\"Niro EV\",\"Niro PHEV\",\"MX-30\",\"Outlander PHEV\",\"Ariya\",\"Leaf SV\",\"Solterra\",\"Model 3\",\"Model 3 Performance\",\"Model Y Long Range\",\"Prius Prime\",\"RAV4 Prime SE AWD\",\"ID.4\",\"ID.4 Pro AWD\"],[\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"PHEV\",\"PHEV\",\"PHEV\",\"PHEV\",\"EV\",\"PHEV\",\"EV\",\"PHEV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"PHEV\",\"PHEV\",\"EV\",\"EV\"],[\"AWD\",\"RWD\",\"FWD\",\"FWD\",\"AWD\",\"RWD\",\"RWD\",\"AWD\",\"RWD\",\"FWD\",\"FWD\",\"AWD\",\"AWD\",\"4WD\",\"4WD\",\"FWD\",\"FWD\",\"FWD\",\"AWD\",\"AWD\",\"FWD\",\"AWD\",\"RWD\",\"AWD\",\"AWD\",\"FWD\",\"AWD\",\"RWD\",\"AWD\"],[394,418,397,417,502,397,386,480,507,304,483,50,52,56,68,407,53,161,61,490,342,360,438,438,531,40,68,336,410],[80770,58260,43150,41550,79120,57000,49000,57660,53000,44600,49700,45000,40100,58280,79830,48100,33840,42650,46540,53000,41250,54300,54990,72990,69990,36790,53060,46050,55050]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>make<\\/th>\\n      <th>model<\\/th>\\n      <th>type<\\/th>\\n      <th>drivetrain<\\/th>\\n      <th>range<\\/th>\\n      <th>price<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[5,6]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Electric Vehicle Types\n\nDistribution of EV and PHEV vehicles\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](choosing-ev_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Electric Vehicle Characteristics by Price\n\nDistribution of vehicles by type, price, and drive train\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](choosing-ev_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n:::\n\n<br> <br>\n\n# Modelling\n\nWhen developing a model specific parameters are needed in order to make an objective evaluation. The main constraint for this model was the ability to drive exclusively using electric power, without limitations (i.e. city, highway, etc.). Because of this requirement only pure electric vehicles and plug-in hybrid vehicles were considered.\n\nThere key factors to the model are\n\n-   Affordability\n-   Driving range\n-   Drive train\n\n<br>\n\n**Affordability** <br> The purchase cost of the vehicle is a very important factor for many. The *price* is considered the advertised price pre taxes, in Canadian dollars, based on a purchase in Nova Scotia. Federal and provincial EV incentives were excluded.\n\n<br>\n\n**Driving range** <br> The EVs primary usage would be for daily commuting, with a round trip distance of \\~60 kms, with the need for extended distance to account for slight variations that are likely to occur daily (i.e. running errands, construction detours, etc.). While daily commuting is the main purpose for the EV, it would be great to be able to use the vehicle for other reasons, specifically lifestyle related activities, such as camping, surfing, skiing, or staycation road trips. The addition of lifestyle means a greater driving range would be desirable.\n\n<br>\n\n**Drive train** <br> Seasonal variations can have significant impacts on driving conditions in Nova Scotia. The weather during the spring, fall, and winter can produce challenging driving conditions. One method to combat difficult road conditions is to have a drive train system that provides more traction.\n\n<br> <br>\n\n## Feature Engineering\n\nThe format of the data collected on the EVs is not conducive to support the design of the model. Rather than modifying the source data (i.e. changing the values to reflected the desired data format values) new features, or attributes, will be created using the source values.\n\n> Feature engineering entails reformatting predictor values to make them easier for a model to use effectively. This includes transformations and encoding of the data to be represent their important characteristics <br> *Tidy Modeling with R* <br> *Max Kuhn & Julie Silge*\n\nSource data elements were used to created three features for use in the model. New features were encoding using values of 0, 1, 3, 6, and 9 providing a clear distinction between the values of the feature.\n\n::: panel-tabset\n### Price\n\nThe following was used when creating new price features\n\n|    **Price Range**    | **Feature Encoding** |\n|:---------------------:|:--------------------:|\n|  Less than \\$30,000   |          9           |\n| \\$30,000 to \\$40,000  |          6           |\n| \\$40,000 to \\$50,000  |          3           |\n| \\$50,000 to \\$60,000  |          1           |\n| Greater than \\$60,000 |          0           |\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to create new feature\n# Specific to electric vehicle price\ncreate_price_feature <- function(.data, price_column){\n  .data |>\n    dplyr::mutate(price_value = dplyr::case_when(\n    {{price_column}} < 30000 ~ 9,\n    dplyr::between({{price_column}}, 30000, 40000) ~ 6,\n    dplyr::between({{price_column}}, 40000, 50000) ~ 3,\n    dplyr::between({{price_column}}, 50000, 60000) ~ 1,\n    {{price_column}} > 60000 ~ 0\n  ))\n}\n```\n:::\n\n\n### Range\n\nThe following was used when creating new driving range (in kilometres) features\n\n| **Driving Range**  | **Feature Encoding** |\n|:------------------:|:--------------------:|\n| Greater than 500km |          9           |\n|    400 to 500km    |          6           |\n|    300 to 400km    |          3           |\n|    200 to 300km    |          1           |\n|  Less than 200km   |          0           |\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to create new feature\n# Specific to electric vehicle range\ncreate_range_feature <- function(.data, range_column){\n  .data |>\n    dplyr::mutate(range_value = dplyr::case_when(\n    {{range_column}} > 500 ~ 9,\n    dplyr::between({{range_column}}, 400, 500) ~ 6,\n    dplyr::between({{range_column}}, 300, 400) ~ 3,\n    dplyr::between({{range_column}}, 200, 300) ~ 1,\n    {{range_column}} < 200 ~ 0\n  ))\n}\n```\n:::\n\n\n### Drive Train\n\nThe following was used when creating new drive train features\n\n|     **Drive Train**     | **Feature Encoding** |\n|:-----------------------:|:--------------------:|\n| Four wheel drive (4WD)  |          9           |\n|  All wheel drive (AWD)  |          6           |\n| Front wheel drive (FWD) |          3           |\n| Rear wheel drive (RWD)  |          1           |\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to create new feature\n# Specific to electric vehicle drivetrain\ncreate_drivetrain_feature <- function(.data, drivetrain_column){\n  .data |>\n    dplyr::mutate(drivetrain_value = dplyr::case_when(\n    {{drivetrain_column}} == \"4WD\" ~ 9,\n    {{drivetrain_column}} == \"AWD\" ~ 6,\n    {{drivetrain_column}} == \"FWD\" ~ 3,\n    {{drivetrain_column}} == \"RWD\" ~ 1\n  ))\n}\n```\n:::\n\n\n### Engineered Dataset\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvehicles |>\n  create_drivetrain_feature(drivetrain) |>\n  create_range_feature(range) |>\n  create_price_feature(price) |>\n  DT::datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-b6338f5e771369625bb1\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b6338f5e771369625bb1\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29],[\"Ford\",\"Ford\",\"Nissan\",\"Nissan\",\"Kia\",\"Kia\",\"Chevy\",\"Chevy\",\"Jeep\",\"Jeep\",\"VW\",\"VW\",\"Subaru\",\"Toyota\",\"Toyota\",\"Mitsubishi\",\"Mazda\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Hyundai\",\"Tesla\",\"Tesla\",\"Tesla\",\"BMW\",\"BMW\",\"Hyundai\"],[\"Mustang Mach-e Select\",\"Mustang Mach-e California Route 1\",\"Ariya\",\"Leaf SV\",\"Niro EV\",\"Niro PHEV\",\"Bolt EV\",\"Bold EUV\",\"4-Door Willys\",\"Grand Cherokee 4XE\",\"ID.4\",\"ID.4 Pro AWD\",\"Solterra\",\"Prius Prime\",\"RAV4 Prime SE AWD\",\"Outlander PHEV\",\"MX-30\",\"Ioniq 5 Preferred\",\"Ioniq 5 Preferred Long Range\",\"Ioniq 5 Preferred AWD Long Range\",\"Kona Preffered\",\"Kona Ultimate\",\"Tuscon Luxury Plug-in Hybrid AWD\",\"Model 3\",\"Model 3 Performance\",\"Model Y Long Range\",\"i4 eDrive35\",\"i4 M50\",\"Santa Fe Luxury Plug-in Hybrid AWD\"],[\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"PHEV\",\"EV\",\"EV\",\"PHEV\",\"PHEV\",\"EV\",\"EV\",\"EV\",\"PHEV\",\"PHEV\",\"PHEV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"PHEV\",\"EV\",\"EV\",\"EV\",\"EV\",\"EV\",\"PHEV\"],[\"RWD\",\"AWD\",\"AWD\",\"FWD\",\"FWD\",\"FWD\",\"FWD\",\"FWD\",\"4WD\",\"4WD\",\"RWD\",\"AWD\",\"AWD\",\"FWD\",\"AWD\",\"AWD\",\"FWD\",\"RWD\",\"RWD\",\"AWD\",\"FWD\",\"FWD\",\"AWD\",\"RWD\",\"AWD\",\"AWD\",\"RWD\",\"AWD\",\"AWD\"],[397,502,490,342,407,53,417,397,56,68,336,410,360,40,68,61,161,386,507,480,304,483,52,438,438,531,418,394,50],[57000,79120,53000,41250,48100,33840,41550,43150,58280,79830,46050,55050,54300,36790,53060,46540,42650,49000,53000,57660,44600,49700,40100,54990,72990,69990,58260,80770,45000],[1,6,6,3,3,3,3,3,9,9,1,6,6,3,6,6,3,1,1,6,3,3,6,1,6,6,1,6,6],[3,9,6,3,6,0,6,3,0,0,3,6,3,0,0,0,0,3,9,6,3,6,0,6,6,9,6,3,0],[1,0,1,3,3,6,3,3,1,0,3,1,1,6,1,3,3,3,1,1,3,3,3,1,0,0,1,0,3]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>id<\\/th>\\n      <th>make<\\/th>\\n      <th>model<\\/th>\\n      <th>type<\\/th>\\n      <th>drivetrain<\\/th>\\n      <th>range<\\/th>\\n      <th>price<\\/th>\\n      <th>drivetrain_value<\\/th>\\n      <th>range_value<\\/th>\\n      <th>price_value<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,6,7,8,9,10]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n:::\n\n<br> <br>\n\n## Designing a Model\n\nThe idea behind the model is to combine the three variables into a single value that can be used to objectively suggest which EVs meet the needs of the user. Using this idea, there are two methods to *combine* the variables, adding or multiplying. For this story two models will be designed, one using an additive approach, and the other using a multiply approach.\n\nA critical aspect of the model is to have a weighting factor for each of the variables. The thought behind this was that some variables are more important than others.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweights <- list(price = 0.6, range = 0.3, drivetrain = 0.1)\n```\n:::\n\n\n**Model Variable Weights**\n\n|   Variable   |         Weight         |\n|:------------:|:----------------------:|\n|   *Price*    |   0.6    |\n|   *Range*    |   0.3    |\n| *Drivetrain* | 0.1 |\n\n<br>\n\n### Model One\n\nThe approach of this model is to apply the variable weight to each variable and **add** each variable together\n\n<br>\n\n$$\n(price * weightPrice) + (range * weightRange) + (drivetrain * weightDrivetrain)\n$$\n\n<br>\n\n::: panel-tabset\n#### Building Model One\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- function(.data, manufacture, model, price, range, drivetrain){\n  .data |>\n    dplyr::mutate(model_output = ({{price}} * weights$price) + ({{range}} * weights$range) + ({{drivetrain}} * weights$drivetrain)) |>\n    dplyr::select({{manufacture}}, {{model}}, model_output)\n}\n```\n:::\n\n\n#### Model One Output\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Applying model one to the vehicle dataset\nvehicles |>\n  model1(manufacture = make,\n         model = model,\n         price = price_value,\n         range = range_value,\n         drivetrain = drivetrain_value)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-202348badb26f9360039\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-202348badb26f9360039\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\"],[\"Chevy\",\"Hyundai\",\"Kia\",\"Kia\",\"Toyota\",\"Hyundai\",\"Ford\",\"Tesla\",\"Chevy\",\"Hyundai\",\"Hyundai\",\"Nissan\",\"Nissan\",\"VW\",\"Hyundai\",\"VW\",\"BMW\",\"Tesla\",\"Hyundai\",\"Hyundai\",\"Mitsubishi\",\"Tesla\",\"Subaru\",\"Mazda\",\"Ford\",\"BMW\",\"Jeep\",\"Toyota\",\"Jeep\"],[\"Bolt EV\",\"Kona Ultimate\",\"Niro EV\",\"Niro PHEV\",\"Prius Prime\",\"Ioniq 5 Preferred Long Range\",\"Mustang Mach-e California Route 1\",\"Model Y Long Range\",\"Bold EUV\",\"Ioniq 5 Preferred AWD Long Range\",\"Kona Preffered\",\"Ariya\",\"Leaf SV\",\"ID.4 Pro AWD\",\"Ioniq 5 Preferred\",\"ID.4\",\"i4 eDrive35\",\"Model 3\",\"Santa Fe Luxury Plug-in Hybrid AWD\",\"Tuscon Luxury Plug-in Hybrid AWD\",\"Outlander PHEV\",\"Model 3 Performance\",\"Solterra\",\"MX-30\",\"Mustang Mach-e Select\",\"i4 M50\",\"4-Door Willys\",\"RAV4 Prime SE AWD\",\"Grand Cherokee 4XE\"],[3.899999999999999,3.899999999999999,3.899999999999999,3.899999999999999,3.899999999999999,3.4,3.3,3.3,3,3,3,3,3,3,2.8,2.8,2.5,2.5,2.4,2.4,2.4,2.4,2.1,2.1,1.6,1.5,1.5,1.2,0.9]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>make<\\/th>\\n      <th>model<\\/th>\\n      <th>model_output<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":3},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Visualizing Model One\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](choosing-ev_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n:::\n\n<br>\n\nThe top five electric vehicles identified from *Model One* are **Chevy Bolt EV, Hyundai Kona Ultimate, Kia Niro EV, Kia Niro PHEV, Toyota Prius Prime**\n\n<br> <br>\n\n### Model Two\n\nThe approach of this model is to apply the variable weight to each variable and **multiply** each variable together\n\n<br>\n\n$$\n(price * weightPrice) * (range * weightRange) * (drivetrain * weightDrivetrain)\n$$\n\n<br>\n\n::: panel-tabset\n#### Building Model Two\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- function(.data, manufacture, model, price, range, drivetrain){\n  .data |>\n    dplyr::mutate(model_output = ({{price}} * weights$price) * ({{range}} * weights$range) * ({{drivetrain}} * weights$drivetrain)) |>\n    dplyr::select({{manufacture}}, {{model}}, model_output)\n}\n```\n:::\n\n\n#### Model Two Output\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Applying model two to the vehicle dataset\nvehicles |>\n  model2(manufacture = make,\n         model = model,\n         price = price_value,\n         range = range_value,\n         drivetrain = drivetrain_value)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-c577d343d2bedf6be2e3\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c577d343d2bedf6be2e3\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\"],[\"Chevy\",\"Hyundai\",\"Kia\",\"Hyundai\",\"Nissan\",\"VW\",\"Chevy\",\"Hyundai\",\"Nissan\",\"Subaru\",\"Hyundai\",\"Hyundai\",\"VW\",\"BMW\",\"Tesla\",\"Ford\",\"BMW\",\"Ford\",\"Hyundai\",\"Hyundai\",\"Jeep\",\"Jeep\",\"Kia\",\"Mazda\",\"Mitsubishi\",\"Tesla\",\"Tesla\",\"Toyota\",\"Toyota\"],[\"Bolt EV\",\"Kona Ultimate\",\"Niro EV\",\"Ioniq 5 Preferred AWD Long Range\",\"Ariya\",\"ID.4 Pro AWD\",\"Bold EUV\",\"Kona Preffered\",\"Leaf SV\",\"Solterra\",\"Ioniq 5 Preferred Long Range\",\"Ioniq 5 Preferred\",\"ID.4\",\"i4 eDrive35\",\"Model 3\",\"Mustang Mach-e Select\",\"i4 M50\",\"Mustang Mach-e California Route 1\",\"Santa Fe Luxury Plug-in Hybrid AWD\",\"Tuscon Luxury Plug-in Hybrid AWD\",\"4-Door Willys\",\"Grand Cherokee 4XE\",\"Niro PHEV\",\"MX-30\",\"Outlander PHEV\",\"Model 3 Performance\",\"Model Y Long Range\",\"Prius Prime\",\"RAV4 Prime SE AWD\"],[0.972,0.972,0.972,0.648,0.648,0.648,0.486,0.486,0.486,0.324,0.162,0.162,0.162,0.108,0.108,0.05399999999999999,0,0,0,0,0,0,0,0,0,0,0,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>make<\\/th>\\n      <th>model<\\/th>\\n      <th>model_output<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":3},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Visualizing Model Two\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](choosing-ev_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n:::\n\n<br>\n\nThe top five electric vehicles identified from *Model Two* are **Chevy Bolt EV, Hyundai Kona Ultimate, Kia Niro EV, Hyundai Ioniq 5 Preferred AWD Long Range, Nissan Ariya, VW ID.4 Pro AWD**\n\n<br> <br>\n\n# In Closing\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nThe top 5 suggestions from each of the models (Model 1 and Model 2) vary slightly. The first **3** suggestions were the same, identifying **Chevy Bolt EV, Hyundai Kona Ultimate, Kia Niro EV**. The forth and fifth suggestions were different between the two models, with **Kia Niro PHEV** from Model 1 and **Hyundai Ioniq 5 Preferred AWD Long Range** from Model 2 as the forth suggestion, and **Toyota Prius Prime** from Model 1 and **Nissan Ariya** from Model 2 as the fifth suggestion.\n\nThe range in price for the top 5 vehicles from Model 1 was **$33,840** to **$49,700**, where as Model 2 top 5 vehicles range were **$41,550** to **$57,660**.\n\nThe suggestions from the two models for top 5 vehicles had a difference in driving range. Model 1 had a range from **40 kms** to **483 kms**, whereas Model 2 had a driving range from **407 kms** to **490 kms**.\n\n<br>\n\nSuggesting electric vehicles with a driving range under 100 kms is contrary to the design requirements. The weighting of price within the design of Model 1 (adding variables) over valued vehicles with a lower purchase price, whereas the design of Model 2 (multiplying variables) reduced the value of vehicles with an insufficient all electric driving range. For this reason, **Model 2** is the preferred model, suggesting **Chevy Bolt EV, Hyundai Kona Ultimate, Kia Niro EV, Hyundai Ioniq 5 Preferred AWD Long Range, Nissan Ariya, VW ID.4 Pro AWD** as the top electric vehicles.\n",
    "supporting": [
      "choosing-ev_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.3/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.30/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}